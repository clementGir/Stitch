
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Start</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <script src="https://use.typekit.net/xlp3tha.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    <link href="assets/css/styles.min.css" rel="stylesheet">
  </head>

  <body><script type='text/javascript' id="__bs_script__">//<![CDATA[
    document.write("<script async src='/browser-sync/browser-sync-client.2.11.1.js'><\/script>".replace("HOST", location.hostname));
//]]></script>

     <!-- HEADER -->
<header>
	<a class="info">
		<span></span>
	</a>
	<a class="login">
		<span></span>
	</a>
</header>

<!-- HOME -->
<section class="section--home">
	<h1>
    <span>stitch</span>
  </h1>
	<h2>
    <span>A webGL experience through music theory</span>
  </h2>
	<a class="tour" href="?p=app">
    <p>Take a tour</p> 
    <span>
      <svg viewBox="0 0 20 30">  
        <line fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" x1="7" y1="7" x2="1" y2="13"/>
  
        <line fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" x1="1" y1="1" x2="7" y2="7"/>
      </svg>
    </span> 
  </a>
  <!-- <ul>
    <li class="treeSixty"></li>
    <li class="vr"></li>
    <li class="audio"></li>
  </ul> -->
</section>

<!-- INFO -->
<section class="section--info">
	<header>
		<a class="close--info">
			<svg viewBox="0 0 14 14">
        <line fill="none" stroke="#8500ff" stroke-linecap="round" stroke-miterlimit="10" x1="1" y1="1" x2="11" y2="11" stroke-width="2px"/>
        <line fill="none" stroke="#8500ff" stroke-linecap="round" stroke-miterlimit="10" x1="11" y1="1" x2="1" y2="11" stroke-width="2px"/>
      </svg>
		</a>
	</header>

	<div class="container">
		<h2>About</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum autem consequatur ullam velit eos beatae itaque, magnam eaque! Corporis harum illo nemo delectus, sed ad saepe, inventore soluta facilis dolor.</p>

		<h2>Process</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum autem consequatur ullam velit eos beatae itaque, magnam eaque! Corporis harum illo nemo delectus, sed ad saepe, inventore soluta facilis dolor.</p>

	</div>
</section>

<!-- SCRIPTS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script type="text/javascript">
	// Show Info
	$('.info').on('click',function() {
		$('.section--info').addClass('info--opened');
	});

	$('.close--info').on('click',function() {
		$('.section--info').removeClass('info--opened');
	});

  // Page transition (entering)
  if ($('body').has('.circles')) {
    $('body').addClass('circlesLoaded');
    setTimeout(function() {
      $('.tour').addClass('loaded');
    }, 2000);
  }

  // Page transition (leaving)
  $('.tour').click(function(e) {
    e.preventDefault();
    $('body').addClass('leaving');
    setTimeout(function() {
      //window.location.href = "?p=app";
    }, 1150);
  });

</script>

<script src="assets/js/three.js"></script>
<script type="text/javascript">

  var r = 4.5;
  var s_r=r/20+Math.sin(0)*r/20;
  var num_of_corners=2;
  var obj_resolution=1024;
  var linewidth=0.005;

  
  var _w = window.innerWidth;
  var _h = window.innerHeight;
  var aspect = _w/ _h;
  var scene = new THREE.Scene(); 
  var camera = new THREE.PerspectiveCamera( 65,  _w/_h, 0.1, 1000 );
  camera.position.z = 10; 
  var renderer = new THREE.WebGLRenderer({ antialias: true } ); 
  renderer.setClearColor(new THREE.Color(0x8500FF, 1.0));
  renderer.setSize( _w, _h ); 

  document.body.appendChild( renderer.domElement )
               .className = "circles";

  var group = new THREE.Object3D();
  var sub_group = new THREE.Object3D();
  var all_vertices=[];
  var all_sub_vertices=[];

  var objects=[];
  var sub_objects=[];
  var num=4;
  var dstnc=0.2;
  var border=0.04;
  var colors=[0xfafafa,0xeeeeee,0x9e9e9e];

  for(var i=0;i<num;i++){
    var obj=create_mesh(colors[i],1+linewidth*0.8*i,all_vertices,i);
    objects.push(obj);
    sub_group   .add(obj);
    obj.rotation.y =Math.PI/180*180;
  } 


  group.rotation.x = sub_group.rotation.x = Math.PI/180*360;
  scene.add(group);
  scene.add(sub_group);

  function create_mesh(clr,r_coof,ver_arr,wave_type){
    var geometry = new THREE.BufferGeometry();
    var points=generate_points(r,s_r,5,wave_type);
    var points2=generate_points(r*(1-linewidth),s_r,5,wave_type);
    var vertices =generate_vertices(points,points2);
    ver_arr.push(vertices);
    geometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );
    var material = new THREE.MeshBasicMaterial( { color: clr } );
    var mesh = new THREE.Mesh( geometry, material );
    mesh.anim_shape=num_of_corners;
    mesh.anim=-1;
    mesh.r_coof=r_coof;
    mesh.wave_type=wave_type;
    return mesh;
  }

  function generate_points(radius,wave_height,anim_shape,wave_type){

    var new_poistions=[];
    for (var i = 0; i <=  obj_resolution; i++) {
      var angle=2*Math.PI/obj_resolution*i;
      var radius_addon=0;
      var speed_incrementer=counter/60;
      var sine_pct=1;

      if(i<sine_pct*obj_resolution||i==obj_resolution){
        var smoothing_amount=0.5;
        var smooth_pct=1;
        if(i<sine_pct*obj_resolution*smoothing_amount)smooth_pct=i/(sine_pct*obj_resolution*smoothing_amount);
        if(i>sine_pct*obj_resolution*(1-smoothing_amount)&&i<=sine_pct*obj_resolution)smooth_pct=(sine_pct*obj_resolution-i)/(sine_pct*obj_resolution*smoothing_amount);
        if(i==obj_resolution)smooth_pct=0;

        if(wave_type==1) radius_addon=wave_height*smooth_pct*Math.cos((angle+speed_incrementer)*anim_shape);
        if(wave_type==0) radius_addon=wave_height*smooth_pct*Math.sin((angle+speed_incrementer)*anim_shape);
        if(wave_type==2) radius_addon=wave_height*smooth_pct*Math.cos((angle+Math.PI/180*200+speed_incrementer)*anim_shape);
      }

      var x = (radius+radius_addon) * Math.cos(angle+speed_incrementer);
      var y = (radius+radius_addon) * Math.sin(angle+speed_incrementer);
      var z = 0;

      new_poistions.push([x,y,z]);
    }

    return new_poistions;
  }


function generate_vertices(points,points2){
   var vertexPositions=[];
   var center_point=[0,0,0];

   for (var i = 0; i <  points.length-1; i++) {
    vertexPositions.push(points[i],points2[i],points[i+1]);
    vertexPositions.push(points2[i],points2[i+1],points[i+1]);
  }
  vertexPositions.push(points[ points.length-1],points2[points.length-1],points[0]);
  vertices = new Float32Array( vertexPositions.length * 3 ); 

  for ( var i = 0; i < vertexPositions.length; i++ )
  {
    vertices[ i*3 + 0 ] = vertexPositions[i][0];
    vertices[ i*3 + 1 ] = vertexPositions[i][1];
    vertices[ i*3 + 2 ] = vertexPositions[i][2];
  }


  return vertices;
}

function update_vertices_v_2(points,points2,my_arr){

  var vertexPositions=[];

  for (var i = 0; i <  points.length-1; i++) {
    vertexPositions.push(points[i],points2[i],points[i+1]);
    vertexPositions.push(points2[i],points2[i+1],points[i+1]);
  }

  vertexPositions.push(points[ points.length-1],points2[points.length-1],points[0]);

  for ( var i = 0; i < vertexPositions.length; i++ ){
    my_arr[ i*3 + 0 ] = vertexPositions[i][0];
    my_arr[ i*3 + 1 ] = vertexPositions[i][1];
    my_arr[ i*3 + 2 ] = vertexPositions[i][2];
  }

}


var last_anim=false;
var delay_time=0.3;
var anim_time=2.12;
var rot_angle=90;
var counter=0;
var counter_anim=0;
var frame=0;
var frame_num=0;
var loop = function loop() {
  requestAnimationFrame(loop);

  for (var k = 0; k <  objects.length; k++) {
    var time=(counter+k)/60;
    var time_sin=Math.sin(time*4);

    var obj=objects[k];
    var rad=r*obj.r_coof;
    s_r=rad/15;
    var points=generate_points(rad,s_r,obj.anim_shape,obj.wave_type); 
    var points2=generate_points(rad*(1-linewidth),s_r,obj.anim_shape,obj.wave_type); 
    update_vertices_v_2(points,points2, all_vertices[k]);
    obj.geometry.attributes.position.needsUpdate = true;

  }

  renderer.render(scene, camera);
  counter++;

};

loop();

function onResize(e) {
  renderer.setSize( window.innerWidth, window.innerHeight ); 
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
}
window.addEventListener('resize', onResize, true);


</script>



















  
  </body>
</html>